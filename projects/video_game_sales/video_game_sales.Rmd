---
title: "Video Game Sales"
author: "Jing Li"
date: '`r format(Sys.time(), "%B %d, %Y")`'
output:
  html_notebook:
    toc: true
    theme: lumen
---

# import data

The dataset was downloaded from [kaggle.com](https://www.kaggle.com/gregorut/videogamesales). 

```{r, echo=FALSE, message=FALSE}
options(width = 119)
library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
options("readr.num_columns" = 0)
vgsales <- read_csv("vgsales.csv")
```

# data overview

There are __11__ variables and __16,598__ observations.

The variables are:

* `Rank`: Ranking of overall sales
* `Name`: The game name
* `Platform`: Platform of the games release (i.e. PC,PS4, etc.)
* `Year`: Year of the game's release
* `Genre`: Genre of the game
* `Publisher`: Publisher of the game
* `NA_Sales`: Sales in North America (in millions)
* `EU_Sales`: Sales in Europe (in millions)
* `JP_Sales`: Sales in Japan (in millions)
* `Other_Sales`: Sales in the rest of the world (in millions)
* `Global_Sales`: Total worldwide sales (in millions)

_(sales are the number of copies)_

Below are the summary statistics for the numerical variables:

```{r, message=FALSE}
vgsales %>% 
  select(contains("_Sales")) %>% 
  summary()
```

# data visualizations

## 1. genre popularity over the years
```{r, fig.width=9}
vgsales %>% 
  ggplot(aes(x = Year, y = Global_Sales, fill = Genre)) +
  geom_bar(stat = "identity") +
  labs(title = "Genre Popularity over Years", x = "Year", y = "Global Sales (in milion copies)") +
  scale_x_discrete(breaks = as.character(seq(from = 1980, to = 2016, by = 4))) +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_brewer(palette = "Set3")
```

It seems that __Action__ game is the dominating genre since 2000, and __Sports__ game is usually the second popular genre.
Also, the global sales peaked around __2008__ and then started to drop drammatically. 

## 2. genre sales by regions

```{r, fig.width=9}
vgsales %>% 
  group_by(Genre) %>% 
  summarise_if(is.numeric, sum) %>% 
  ungroup() %>% 
  gather(Region, Sales, NA_Sales:Global_Sales) %>% 
  mutate(Region = str_replace(Region, "_Sales$", "") %>% 
           factor(levels = c("NA", "EU", "JP", "Other", "Global"),
                  labels = c("North America", "Europe", "Japan", "Other", "Global"))) %>% 
  ggplot(aes(x = Region, y = Genre)) +
  geom_tile(aes(fill = Sales)) +
  labs(title = "Genre Sales by Regions", x = "Region", y = "Genre") +
  scale_fill_continuous(name = "Sales\n(in million copies)") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5), legend.title.align = 0)
```

The sales numbers are aggregated to remove the time dimension. From the graph above, we can see that in terms of sales, people from `North America` and those from `Europe` have very similar tastes as they all prefer __Action__, __Sports__, __Shooter__, and 
__Platform__ over others, though in terms of absolute numbers, games are sold more in `North America` than in `Europe`. 

However, in `Japan`, the most popular genre is __Role-Playing__, which might be due to the cultural differences.

Globally, __Action__ and __Sports__ are the most popular genres.

